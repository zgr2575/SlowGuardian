(()=>{function p(){let t=new URL(self.__scramjet$bundle.rewriters.url.decodeUrl(location.href));return t.assign=r=>location.assign(self.__scramjet$bundle.rewriters.url.encodeUrl(r)),t.reload=()=>location.reload(),t.replace=r=>location.replace(self.__scramjet$bundle.rewriters.url.encodeUrl(r)),t.toString=()=>t.href,t}function d(){let t=p();return new Proxy(window.location,{get(r,e){return t[e]},set(r,e,s){return e==="href"?location.href=self.__scramjet$bundle.rewriters.url.encodeUrl(s):t[e]=s,!0}})}window.__location=d();trustedTypes.createPolicy=new Proxy(trustedTypes.createPolicy,{apply(t,r,e){return e[1].createHTML&&(e[1].createHTML=new Proxy(e[1].createHTML,{apply(s,n,o){return self.__scramjet$bundle.rewriters.rewriteHtml(s(...o))}})),e[1].createScript&&(e[1].createScript=new Proxy(e[1].createScript,{apply(s,n,o){return self.__scramjet$bundle.rewriters.rewriteJs(s(...o))}})),e[1].createScriptURL&&(e[1].createScriptURL=new Proxy(e[1].createScriptURL,{apply(s,n,o){return self.__scramjet$bundle.rewriters.url.encodeUrl(s(...o))}})),Reflect.apply(t,r,e)}});var u=new Proxy(Function,{construct(t,r){return r.length===1?Reflect.construct(t,self.__scramjet$bundle.rewriters.rewriteJs(r[0])):Reflect.construct(t,self.__scramjet$bundle.rewriters.rewriteJs(r[r.length-1]))},apply(t,r,e){return e.length===1?Reflect.apply(t,void 0,self.__scramjet$bundle.rewriters.rewriteJs(e[0])):Reflect.apply(t,void 0,[...e.map((s,n)=>n===e.length-1),self.__scramjet$bundle.rewriters.rewriteJs(e[e.length-1])])}});delete window.Function;window.Function=u;delete window.eval;window.eval=t=>window.Function(t);function i(t){return Object.keys(t).filter(r=>r.startsWith(window.__location.host))}function l(t){return new Proxy(t,{get(r,e,s){switch(e){case"getItem":return n=>r.getItem(window.__location.host+"@"+n);case"setItem":return(n,o)=>{r.setItem(window.__location.host+"@"+n,o)};case"removeItem":return n=>{r.removeItem(window.__location.host+"@"+n)};case"clear":return()=>{i(r).forEach(n=>r.removeItem(n))};case"key":return n=>r[i(r)[n]];case"length":return i(r).length}},defineProperty(r,e,s){return r.setItem(e,s.value),!0}})}var m=l(window.localStorage),w=l(window.sessionStorage);delete window.localStorage;delete window.sessionStorage;window.localStorage=m;window.sessionStorage=w;var c={nonce:[HTMLElement],integrity:[HTMLScriptElement,HTMLLinkElement],csp:[HTMLIFrameElement],src:[HTMLImageElement,HTMLMediaElement,HTMLIFrameElement,HTMLEmbedElement,HTMLScriptElement],href:[HTMLAnchorElement,HTMLLinkElement],data:[HTMLObjectElement],action:[HTMLFormElement],formaction:[HTMLButtonElement,HTMLInputElement],srcdoc:[HTMLIFrameElement],srcset:[HTMLImageElement,HTMLSourceElement],imagesrcset:[HTMLLinkElement],style:[HTMLElement]};Object.keys(c).forEach(t=>{c[t].forEach(r=>{let e=Object.getOwnPropertyDescriptor(r.prototype,t);Object.defineProperty(r.prototype,t,{get(){return e.get.call(this,[this.dataset[`_${t}`]])},set(s){if(this.dataset[`_${t}`]=s,/nonce|integrity|csp/.test(t))this.removeAttribute(t);else if(/src|href|data|action|formaction/.test(t)){if(s instanceof TrustedScriptURL)return;s=self.__scramjet$bundle.rewriters.url.encodeUrl(s)}else t==="srcdoc"?s=self.__scramjet$bundle.rewriters.rewriteHtml(s):/(image)?srcset/.test(t)?s=self.__scramjet$bundle.rewriters.rewriteSrcset(s):t==="style"&&(s=self.__scramjet$bundle.rewriters.rewriteCss(s));e.set.call(this,s)}})})});HTMLElement.prototype.getAttribute=new Proxy(Element.prototype.getAttribute,{apply(t,r,e){return console.log(r),Object.keys(c).includes(e[0])&&(e[0]=`_${e[0]}`),Reflect.apply(t,r,e)}});HTMLElement.prototype.setAttribute=new Proxy(Element.prototype.setAttribute,{apply(t,r,e){if(Object.keys(c).includes(e[0])){if(r.dataset[`_${e[0]}`]=e[1],/nonce|integrity|csp/.test(e[0]))return;/src|href|data|action|formaction/.test(e[0])?(console.log(r),e[1]=self.__scramjet$bundle.rewriters.url.encodeUrl(e[1])):e[0]==="srcdoc"?e[1]=self.__scramjet$bundle.rewriters.rewriteHtml(e[1]):/(image)?srcset/.test(e[0])?e[1]=self.__scramjet$bundle.rewriters.rewriteSrcset(e[1]):e[1]==="style"&&(e[1]=self.__scramjet$bundle.rewriters.rewriteCss(e[1]))}return Reflect.apply(t,r,e)}});var f=Object.getOwnPropertyDescriptor(Element.prototype,"innerHTML");Object.defineProperty(HTMLElement.prototype,"innerHTML",{set(t){return this instanceof HTMLScriptElement?t instanceof TrustedScript||(t=self.__scramjet$bundle.rewriters.rewriteJs(t)):this instanceof HTMLStyleElement?t=self.__scramjet$bundle.rewriters.rewriteCss(t):t instanceof TrustedHTML||(t=self.__scramjet$bundle.rewriters.rewriteHtml(t)),f.set.call(this,t)}});window.fetch=new Proxy(window.fetch,{apply(t,r,e){return e[0]=self.__scramjet$bundle.rewriters.url.encodeUrl(e[0]),Reflect.apply(t,r,e)}});Headers=new Proxy(Headers,{construct(t,r,e){return r[0]=self.__scramjet$bundle.rewriters.rewriteHeaders(r[0]),Reflect.construct(t,r,e)}});Request=new Proxy(Request,{construct(t,r,e){return typeof r[0]=="string"&&(r[0]=self.__scramjet$bundle.rewriters.url.encodeUrl(r[0])),Reflect.construct(t,r,e)}});Response.redirect=new Proxy(Response.redirect,{apply(t,r,e){return e[0]=self.__scramjet$bundle.rewriters.url.encodeUrl(e[0]),Reflect.apply(t,r,e)}});XMLHttpRequest.prototype.open=new Proxy(XMLHttpRequest.prototype.open,{apply(t,r,e){return e[1]&&(e[1]=self.__scramjet$bundle.rewriters.url.encodeUrl(e[1])),Reflect.apply(t,r,e)}});XMLHttpRequest.prototype.setRequestHeader=new Proxy(XMLHttpRequest.prototype.setRequestHeader,{apply(t,r,e){let s=Object.fromEntries(e);return s=self.__scramjet$bundle.rewriters.rewriteHeaders(s),e=Object.entries(s),Reflect.apply(t,r,e)}});var _=["background","background-image","mask","mask-image","list-style","list-style-image","border-image","border-image-source","cursor"],b=["background","backgroundImage","mask","maskImage","listStyle","listStyleImage","borderImage","borderImageSource","cursor"];CSSStyleDeclaration.prototype.setProperty=new Proxy(CSSStyleDeclaration.prototype.setProperty,{apply(t,r,e){return _.includes(e[0])&&(e[1]=self.__scramjet$bundle.rewriters.rewriteCss(e[1])),Reflect.apply(t,r,e)}});b.forEach(t=>{let r=Object.getOwnPropertyDescriptor(CSSStyleDeclaration.prototype,t);Object.defineProperty(CSSStyleDeclaration.prototype,t,{set(e){r.set.call(this,self.__scramjet$bundle.rewriters.rewriteCss(e))}})});})();
